<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://hannesweissteiner.com name=base><title>
            
                TEEcorrelate: An Information-Preserving Defense against Performance-Counter Attacks on TEEs
            
        </title><meta content="TEEcorrelate: An Information-Preserving Defense against Performance-Counter Attacks on TEEs" property=og:title><meta content="I am a PhD Student in CoreSec at ISEC at Graz University of Technology as part of the CoreSec group. My research area is side-channel attacks and defenses." property=og:description><meta content="I am a PhD Student in CoreSec at ISEC at Graz University of Technology as part of the CoreSec group. My research area is side-channel attacks and defenses." name=description><link href=/images/favicons/favicon-96x96.png rel=icon sizes=96x96 type=image/png><link href=/images/favicons/favicon.svg rel=icon type=image/svg+xml><link rel="shortcut icon" href=/images/favicons/favicon.ico><link href=/images/favicons/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/images/favicons/site.webmanifest rel=manifest><link href=https://hannesweissteiner.com/fonts.css rel=stylesheet><script src=https://hannesweissteiner.com/js/codeblock.js></script><link href=https://hannesweissteiner.com/theme/light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://hannesweissteiner.com/theme/dark.css rel=stylesheet><script src=https://hannesweissteiner.com/js/themetoggle.js></script><script>if(window.matchMedia(`(prefers-color-scheme: dark)`).matches){setTheme(`dark`)}else{setTheme(`light`)}</script><link href=https://hannesweissteiner.com/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://hannesweissteiner.com>Hannes Weissteiner</a><div class=socials><a class=social href=https://bsky.app/profile/hannesweissteiner.com rel=me> <img alt=BlueSky src=https://hannesweissteiner.com/icons/social/bluesky.svg> </a><a class=social href=https://github.com/hweissi/ rel=me> <img alt=GitHub src=https://hannesweissteiner.com/icons/social/github.svg> </a><a class=social href=https://infosec.exchange/@hweissi rel=me> <img alt=Mastodon src=https://hannesweissteiner.com/icons/social/mastodon.svg> </a><a class=social href=https://x.com/@hweissi rel=me> <img alt=X src=https://hannesweissteiner.com/icons/social/x-twitter.svg> </a><a class=social href=mailto:hannes.weissteiner@tugraz.at rel=me> <img alt=email src=https://hannesweissteiner.com/icons/social/email.svg> </a></div></div><nav><a href=https://hannesweissteiner.com style=margin-left:.25em>/about</a><a href=https://hannesweissteiner.com/publications style=margin-left:.25em>/publications</a></nav></header><main><article><div class=title><h1><div class=page-header>TEEcorrelate: An Information-Preserving Defense against Performance-Counter Attacks on TEEs<span class=primary-color style=font-size:1.6em>.</span></div></h1><div class=meta>234 Words</div></div><section class=body><h2 id=abstract>Abstract</h2><p>Trusted-execution environments (TEEs) offer confidentiality in shared environments. While Intel restricts performance counter access, limiting load-balancing and anomaly detection on TEEs, AMD exposes performance counters to the host, leaving the TEE vulnerable to side-channel leakage.<p>In this paper, we propose TEEcorrelate, a lightweight information-preserving defense against performance-counter attacks on TEEs. TEEcorrelate reconciles monitoring capabilities of the host and confidentiality requirements of the TEE, by statistically decorrelating performance counters. TEEcorrelate combines two components, temporal decorrelation using counter aggregation windows, and value decorrelation using fuzzy performance counter increases. With default parameters, TEEcorrelate guarantees that the host can read performance counters hundreds of times per second, while the read value never deviates by more than 1024 from the actual value. Hence, the host can still use them for load-balancing, accounting, and detection of unusual or malicious activity. In state-of-the-art attacks on MbedTLS RSA 4096, a TOTP implementation, and the post-quantum HQC key-encapsulation mechanism, attack runtimes increase from 0.58 - 429 seconds to 1 - 775.6 days, even for a powerful, fully-informed attacker. We estimate that TEEcorrelate on AMD SEV-SNP has a negligible performance impact of 0.03 % for most context switches, and overall less than 0.09 %. Hence, TEEcorrelate is an effective low cost mitigation for all TEEs.<p>[<a href=/pdfs/teecorrelate.pdf>Read Paper</a>] [<a href=/pdfs/slides/teecorrelate-slides-USENIX.pdf>USENIX Slides</a>] [<a href=/pdfs/posters/teecorrelate-poster-USENIX.pdf>USENIX Poster</a>]<h2 id=cite>Cite</h2><pre class=language-bibtex data-lang=bibtex style=color:#f8f8f2;background-color:#191919><code class=language-bibtex data-lang=bibtex><span style=color:#ff5e5e>@inproceedings</span><span>{Weissteiner2025TEEcorrelate,
</span><span> </span><span style=color:#fbe3bf>author </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>Weissteiner, Hannes and Rauscher, Fabian and Schr{\"o}der, Robin Leander and Juffinger, Jonas and Gast, Stefan and Wichelmann, Jan and Eisenbarth, Thomas and Gruss, Daniel</span><span style=color:#fff>}</span><span>,
</span><span> </span><span style=color:#fbe3bf>booktitle </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>USENIX Security</span><span style=color:#fff>}</span><span>,
</span><span> </span><span style=color:#fbe3bf>title </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>{TEEcorrelate: An Information-Preserving Defense against Performance-Counter Attacks on TEEs}</span><span style=color:#fff>}</span><span>,
</span><span> </span><span style=color:#fbe3bf>year </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>2025</span><span style=color:#fff>}
</span><span>}
</span></code></pre></section></article></main></div>