<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://hannesweissteiner.com name=base><title>
            
                TDXploit: Novel Techniques for Single-Stepping and Cache Attacks on Intel TDX
            
        </title><meta content="TDXploit: Novel Techniques for Single-Stepping and Cache Attacks on Intel TDX" property=og:title><meta content="I am a PhD Student in CoreSec at ISEC at Graz University of Technology as part of the CoreSec group. My research area is side-channel attacks and defenses." property=og:description><meta content="I am a PhD Student in CoreSec at ISEC at Graz University of Technology as part of the CoreSec group. My research area is side-channel attacks and defenses." name=description><link href=/images/favicons/favicon-96x96.png rel=icon sizes=96x96 type=image/png><link href=/images/favicons/favicon.svg rel=icon type=image/svg+xml><link rel="shortcut icon" href=/images/favicons/favicon.ico><link href=/images/favicons/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/images/favicons/site.webmanifest rel=manifest><link href=https://hannesweissteiner.com/fonts.css rel=stylesheet><script src=https://hannesweissteiner.com/js/codeblock.js></script><link href=https://hannesweissteiner.com/theme/light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://hannesweissteiner.com/theme/dark.css rel=stylesheet><script src=https://hannesweissteiner.com/js/themetoggle.js></script><script>if(window.matchMedia(`(prefers-color-scheme: dark)`).matches){setTheme(`dark`)}else{setTheme(`light`)}</script><link href=https://hannesweissteiner.com/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://hannesweissteiner.com>Hannes Weissteiner</a><div class=socials><a class=social href=https://bsky.app/profile/hannesweissteiner.com rel=me> <img alt=BlueSky src=https://hannesweissteiner.com/icons/social/bluesky.svg> </a><a class=social href=https://github.com/hweissi/ rel=me> <img alt=GitHub src=https://hannesweissteiner.com/icons/social/github.svg> </a><a class=social href=https://infosec.exchange/@hweissi rel=me> <img alt=Mastodon src=https://hannesweissteiner.com/icons/social/mastodon.svg> </a><a class=social href=https://x.com/@hweissi rel=me> <img alt=X src=https://hannesweissteiner.com/icons/social/x-twitter.svg> </a><a class=social href=mailto:hannes.weissteiner@tugraz.at rel=me> <img alt=email src=https://hannesweissteiner.com/icons/social/email.svg> </a></div></div><nav><a href=https://hannesweissteiner.com style=margin-left:.25em>/about</a><a href=https://hannesweissteiner.com/publications style=margin-left:.25em>/publications</a></nav></header><main><article><div class=title><h1><div class=page-header>TDXploit: Novel Techniques for Single-Stepping and Cache Attacks on Intel TDX<span class=primary-color style=font-size:1.6em>.</span></div></h1><div class=meta>305 Words</div></div><section class=body><h2 id=abstract>Abstract</h2><p>Intel TDX is a trusted execution environment (TEE) protecting arbitrary code, e.g., an entire OS, from the host system in trust domains (TDs). While TDX isolates the memory of TDs, side channels are still a threat due to shared hardware. Prior work showed that single-stepping is a powerful technique for attacking TEEs. After TDX was found vulnerable to these attacks, Intel improved their mitigations with TDX module version 1.5.06, stopping all known single-stepping attacks.<p>In this paper, we introduce TDXploit, a novel technique to revive single-stepping attacks on Intel TDX. TDXploit exploits a fundamental flaw in Intel’s single-stepping mitigation, ironically, achieving a higher (>99.99 %) single-stepping accuracy than without mitigations. We recover the mitigation’s internal state using an attacker-controlled TD. We not only predict the mitigation’s behavior without any side channel but also manipulate it for reliable single- and multi-stepping. TDXploit can perform one single-step every 3.7 ms. We evaluate TDXploit with an attack on ECDSA in OpenSSL. Furthermore, we systematically evaluate 6 state-of-the-art sidechannel attack techniques on TDX and their compatibility with TDXploit. A key finding is that clflush bypasses Intel’s defenses, allowing Flush+Flush attacks on TDX guest physical memory. Compared to all previous Flush+Flush attacks, our Flush+Flush attack requires no shared memory and can target any memory location of a TD. We demonstrate the impact of this finding in a full key recovery on an AES TTable implementation, requiring only 8 986 encryption traces. Finally, we combine our novel Flush+Flush with TDXploit to leak TOTP secrets with a single trace. We conclude that further mitigations against single-stepping and side channels on TDX are necessary.<p>[<a href=https://fabianrauscher.com/papers/tdxploit.pdf>Read Paper</a>] [<a href=https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-01312.html>CVE-2025-20613</a>]<h2 id=cite>Cite</h2><pre class=language-bibtex data-lang=bibtex style=color:#f8f8f2;background-color:#191919><code class=language-bibtex data-lang=bibtex><span style=color:#ff5e5e>@inproceedings</span><span>{Rauscher2025TDXploit,
</span><span> </span><span style=color:#fbe3bf>author </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>Rauscher, Fabian and Wilke, Luca and Weissteiner, Hannes Eisenbarth, Thomas and Gruss, Daniel</span><span style=color:#fff>}</span><span>,
</span><span> </span><span style=color:#fbe3bf>booktitle </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>USENIX Security</span><span style=color:#fff>}</span><span>,
</span><span> </span><span style=color:#fbe3bf>title </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>{TDXploit: Novel Techniques for Single-Stepping and Cache Attacks on Intel TDX}</span><span style=color:#fff>}</span><span>,
</span><span> </span><span style=color:#fbe3bf>year </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>2025</span><span style=color:#fff>}
</span><span>}
</span></code></pre></section></article></main></div>