<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         CRACKPIPE - Covertly Reconstructing Arbitrary Code tracKs using Per-Instruction Performance-counter Evaluation
        
    </title><meta content="CRACKPIPE - Covertly Reconstructing Arbitrary Code tracKs using Per-Instruction Performance-counter Evaluation" property=og:title><link href=https://hannesweissteiner.xyz/fonts.css rel=stylesheet><script src=https://hannesweissteiner.xyz/js/codeblock.js></script><link title="Hannes Weissteiner" href=https://hannesweissteiner.xyz/atom.xml rel=alternate type=application/atom+xml><link href=https://hannesweissteiner.xyz/theme/light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://hannesweissteiner.xyz/theme/dark.css rel=stylesheet><script src=https://hannesweissteiner.xyz/js/themetoggle.js></script><script>if(window.matchMedia(`(prefers-color-scheme: dark)`).matches){setTheme(`dark`)}else{setTheme(`light`)}</script><link href=https://hannesweissteiner.xyz/main.css media=screen rel=stylesheet><script src=https://hannesweissteiner.xyz/js/mermaid.js></script><body><div class=content><header><div class=main><a href=https://hannesweissteiner.xyz>Hannes Weissteiner</a><div class=socials><a class=social href=https://bsky.app/profile/hannesweissteiner.xyz rel=me> <img alt=BlueSky src=https://hannesweissteiner.xyz/social_icons/bluesky.svg> </a><a class=social href=https://github.com/hweissi/ rel=me> <img alt=GitHub src=https://hannesweissteiner.xyz/social_icons/github.svg> </a><a class=social href=https://infosec.exchange/@hweissi rel=me> <img alt=Mastodon src=https://hannesweissteiner.xyz/social_icons/mastodon.svg> </a><a class=social href=https://x.com/@hweissi rel=me> <img alt=X src=https://hannesweissteiner.xyz/social_icons/x-twitter.svg> </a><a class=social href=mailto://hannes.weissteiner@iaik.tugraz.at rel=me> <img alt=email src=https://hannesweissteiner.xyz/social_icons/email.svg> </a></div></div><nav><a href=https://hannesweissteiner.xyz style=margin-left:.5em>/about</a><a href=https://hannesweissteiner.xyz/publications style=margin-left:.5em>/publications</a></nav></header><main><article><div class=title><div class=page-header>CRACKPIPE - Covertly Reconstructing Arbitrary Code tracKs using Per-Instruction Performance-counter Evaluation<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2024-04-01</time></div></div><section class=body><h1 id=abstract>Abstract</h1><p>AMD SEV is a processor extension that has been introduced to provide cloud customers with integrity and confidentiality guarantees in a shared hosting environment. Encryption, combined with access restrictions, ensures that a cloud provider cannot access or modify customer data. For this purpose, SEV and its extensions ES and SNP enable a variety of new features to limit the capabilities of a potentially malicious hypervisor. In this thesis, we demonstrate that some processor performance statistics available to privileged attackers can be used to break the system’s confidentiality guarantees. We present the CRACKPIPE attack, in which a malicious hypervisor abuses performance counter differences to leak secret data out of an SEV-SNP protected virtual machine. CRACKPIPE interrupts the guest virtual machine after each instruction to precisely determine the outcomes of conditional branches, and recovers secrets from the resulting trace. Therefore, despite enabling all protection features of AMD SEV-SNP, the CPU remains vulnerable to CRACKPIPE. In multiple case studies, we demonstrate how the underlying primitive can be used in real-world attacks to recover keys from cryptographic algorithms, such as RSA, or drastically reduce the time complexity of a brute-force attack. Finally, we discuss how mitigations for CRACKPIPE impose trade-offs, such as performance overhead or limiting the hypervisor’s ability to detect malicious guests.<p>[<a href=/pdfs/crackpipe.pdf>Read Thesis</a>]<h1 id=cite>Cite</h1><pre class=language-bibtex data-lang=bibtex style=color:#f8f8f2;background-color:#191919><code class=language-bibtex data-lang=bibtex><span style=color:#ff5e5e>@mastersthesis</span><span>{Weissteiner2024CRACKPIPE,
</span><span>  </span><span style=color:#fbe3bf>author  </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>Weissteiner, Hannes</span><span style=color:#fff>}</span><span>,
</span><span>  </span><span style=color:#fbe3bf>title   </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>{CRACKPIPE -- Covertly Reconstructing Arbitrary Code tracKs using Per-Instruction Performance-counter Evaluation}</span><span style=color:#fff>}</span><span>,
</span><span>  </span><span style=color:#fbe3bf>school  </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>Graz University of Technology</span><span style=color:#fff>}</span><span>,
</span><span>  </span><span style=color:#fbe3bf>year    </span><span>= </span><span style=color:#fff>{</span><span style=color:#fbe3bf>2024</span><span style=color:#fff>}
</span><span>}
</span></code></pre></section></article></main></div>